---
title: "ForMakingPkg"
author: "Zhenyu"
date: "11/4/2021"
output: html_document
---

```{r setup, include=FALSE}
library(devtools, usethis)
library(Rcpp)
```

```{r}
use_package("RcppParallel")
use_package("RcppXsimd")
use_package("Rcpp")
load_all()
check()
use_mit_license()
usethis::use_rcpp() #you have to run this command in the same directory where src/ is
document()
?rcmg
```

```{r tmp test rcmg}
load_all()
n = 100
mean = c(0.2, 0.2)
prec = matrix(data = c(1, 0.5, 0.5, 1), nrow = 2)
constraits = 0
p0 = c(1, -1)
t = 2
burnin = 20
debugSource("~/zigzag/R/hzz.R", echo=TRUE)
rcmg(n, mean = c(0, 0), prec, constraits, t, burnin = 0, p0 = c(0.1 , -0.1))
```

```{r}
debugSource("~/truncated-normal-sampler-code/truncated-normal-sampler-code/truncated_normal_hmc.R", echo=TRUE)
f <- function (x) {
  if (length(x) == 1) {
    prec[, x]
  } else {
    drop(prec %*% x)
  }
}

t <- 2
n_samples <- 1
samples <- array(0, c(2, n_samples))

x <- c(0.1 , -0.1)
tic <- proc.time()
for (i in 1:n_samples) {
  t_jittered <- t 

  x <- truncated_normal_hmc(f, x, mu = c(0,0), t_jittered, m=NULL)
  samples[, i] <- x
}
samples
```


